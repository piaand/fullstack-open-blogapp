(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{71:function(e,t,n){},96:function(e,t,n){},97:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(25),s=n.n(a),o=n(9),i=(n(71),n(22)),u=n(10),l=n(4),j=n.n(l),b=n(7),d=n(21),f=n.n(d),p="/api/blogs",O=null,h=function(){var e=Object(b.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get(p);case 2:return t=e.sent,console.log("Getting all blogs: ",t.data),e.abrupt("return",t.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=Object(b.a)(j.a.mark((function e(t){var n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:O}},e.next=3,f.a.post(p,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=Object(b.a)(j.a.mark((function e(t){var n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=p+"/"+t,e.next=3,f.a.get(n);case 3:return r=e.sent,console.log("Getting a blog: ",r.data),e.abrupt("return",r.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=Object(b.a)(j.a.mark((function e(t,n){var r,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=p+"/"+t,e.next=3,f.a.put(r,n);case 3:return c=e.sent,e.abrupt("return",c.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),m=function(){var e=Object(b.a)(j.a.mark((function e(t,n){var r,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=p+"/"+t+"/comments",e.next=3,f.a.post(r,n);case 3:return c=e.sent,e.abrupt("return",c.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),w={getAll:h,setToken:function(e){O="bearer ".concat(e)},create:x,getBlog:v,update:g,removeBlog:function(){var e=Object(b.a)(j.a.mark((function e(t){var n,r,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:O}},r=p+"/"+t,e.next=4,f.a.delete(r,n);case 4:return c=e.sent,e.abrupt("return",c.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),addComment:m},y={login:function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},k=function(e){return function(){var t=Object(b.a)(j.a.mark((function t(n){var r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,y.login(e);case 3:r=t.sent,window.localStorage.setItem("loggedBlogAppUser",JSON.stringify(r)),w.setToken(r.token),n({type:"LOGIN",data:r}),t.next=12;break;case 9:return t.prev=9,t.t0=t.catch(0),t.abrupt("return",Promise.reject("Invalid login"));case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()},B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":case"RETRIEVE":return t.data;case"LOGOUT":return null;default:return e}},L=n(126),E=n(113),I=n(114),N=n(1),T=function(e){var t=e.user,n=e.handleLogout;return Object(N.jsxs)("div",{className:"loggedUser",children:["Logged in as ",t.name,"\xa0",Object(N.jsx)(L.a,{onClick:n,color:"inherit",children:"Log out"})]})},C=function(){return Object(N.jsxs)("div",{children:[Object(N.jsx)(L.a,{color:"inherit",children:Object(N.jsx)(i.b,{to:"/users",children:"users"})}),Object(N.jsx)(L.a,{color:"inherit",children:Object(N.jsx)(i.b,{to:"/blogs",children:"blogs"})})]})},G=function(){var e=Object(o.c)((function(e){return e.user})),t=Object(o.b)(),n=Object(u.g)();return Object(N.jsx)(E.a,{position:"static",children:Object(N.jsxs)(I.a,{children:[Object(N.jsx)(C,{}),null!==e&&Object(N.jsx)(T,{user:e,handleLogout:function(){t(function(){var e=Object(b.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.localStorage.removeItem("loggedBlogAppUser"),w.setToken(null),t({type:"LOGOUT"});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n.push("/login")}})]})})},S=n(15),A=n(24),R=n(36),_=function(e,t){var n=Object(r.useState)(""),c=Object(R.a)(n,2),a=c[0],s=c[1];return{value:a,type:e,name:t,onChange:function(e){s(e.target.value)},reset:function(){s("")}}},D=null,U=function(e){return function(){var t=Object(b.a)(j.a.mark((function t(n){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:D&&clearTimeout(D),n({type:"CHANGE",data:{notification:e}}),D=setTimeout((function(){n({type:"CHANGE",data:{notification:null}})}),5e3);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CHANGE":return t.data.notification;default:return e}},H=function(e){var t=e.tryLogin,n=_("text","username"),r=n.reset,c=Object(A.a)(n,["reset"]),a=_("text","password"),s=a.reset,o=Object(A.a)(a,["reset"]);return Object(N.jsxs)("div",{children:[Object(N.jsx)("h3",{children:"Login to view your blogs!"}),Object(N.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t({username:c.value,password:o.value}),r(),s()},children:[Object(N.jsxs)("div",{children:["username: ",Object(N.jsx)("input",Object(S.a)({},c))]}),Object(N.jsxs)("div",{children:["password: ",Object(N.jsx)("input",Object(S.a)({},o))]}),Object(N.jsx)("button",{id:"loginButton",type:"submit",children:"Login"})]})]})},z=function(){var e=Object(o.b)(),t=function(){var t=Object(b.a)(j.a.mark((function t(n){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e(k(n));case 3:t.next=9;break;case 5:t.prev=5,t.t0=t.catch(0),console.log(t.t0),e(U("Wrong username or password"));case 9:case"end":return t.stop()}}),t,null,[[0,5]])})));return function(e){return t.apply(this,arguments)}}();return Object(N.jsx)(H,{tryLogin:t})},J=function(){var e=Object(o.c)((function(e){return e.notification}));return null===e||e.lenght<1?null:Object(N.jsx)("div",{className:"notification",style:{color:"green",background:"lightgrey",fontSize:20,borderStyle:"solid",borderRadius:5,padding:10,marginBottom:10},children:e})},V=function(e,t,n){var r={id:e,username:n.username,name:n.name};return Object(S.a)(Object(S.a)({},t),{},{user:r})},W=function(e,t){return function(){var n=Object(b.a)(j.a.mark((function n(r){var c,a;return j.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,w.create(e);case 3:c=n.sent,a=V(c.user,c,t),r({type:"ADD_BLOG",data:a}),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),console.log(n.t0);case 11:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(e){return n.apply(this,arguments)}}()},F=function(e){return function(){var t=Object(b.a)(j.a.mark((function t(n){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,w.removeBlog(e);case 3:n({type:"DELETE_BLOG",data:e}),t.next=10;break;case 6:t.prev=6,t.t0=t.catch(0),console.log("Met exception"),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e){return t.apply(this,arguments)}}()},K=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_BLOG":return t.data;case"ADD_BLOG":return e.concat(t.data);case"LIKE_BLOG":case"COMMENT_BLOG":return e.map((function(e){return e.id!==t.data.id?e:t.data}));case"DELETE_BLOG":return e.filter((function(e){return e.id!==t.data}));default:return e}},P={getUsers:function(){var e=Object(b.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.a.get("/api/users");case 3:return t=e.sent,e.abrupt("return",t.data);case 7:e.prev=7,e.t0=e.catch(0),console.log("Error getting users: "),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}()},q=function(){return function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,P.getUsers();case 3:n=e.sent,t({type:"INIT_LISTERS",data:n}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()},Q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_LISTERS":return t.data;default:return e}},X=n(116),Y=n(127),Z=n(117),$=n(118),ee=n(115),te=Object(ee.a)({mainBlogInfo:{borderBottom:"solid #ecf2f9 2px"}}),ne=function(e){var t=e.blog,n=e.postComment,r=_("text","comment"),c=r.reset,a=Object(A.a)(r,["reset"]);return Object(N.jsxs)("div",{children:[Object(N.jsx)("h4",{children:"Write a new comment"}),Object(N.jsxs)("form",{onSubmit:function(e){e.preventDefault(),n(a.value),c()},children:[Object(N.jsxs)("div",{children:["Comment:\xa0 ",Object(N.jsx)("input",Object(S.a)({},a))]}),Object(N.jsx)("button",{id:"addCommentButton",type:"submit",children:"Post!"})]}),Object(N.jsxs)("div",{children:[Object(N.jsx)("h3",{children:"Comments:"}),Object(N.jsx)("ul",{children:t.comments&&t.comments.map((function(e){return Object(N.jsx)("li",{children:e.content},e.id)}))})]})]})},re=function(e){var t=e.blog,n=e.likeBlog,r=e.deleteBlog,c=te();return Object(N.jsxs)(X.a,{children:[Object(N.jsx)(Y.a,{className:c.mainBlogInfo,title:t.title}),Object(N.jsxs)(Z.a,{className:"extendedBlogInfo",children:[Object(N.jsxs)("p",{children:["by ",t.author]}),Object(N.jsx)("p",{children:t.url}),Object(N.jsxs)("p",{children:["Added by: ",t.user&&t.user.name]}),Object(N.jsxs)($.a,{children:[Object(N.jsx)("i",{className:"fas fa-heart"}),Object(N.jsx)("span",{id:"likeAmount",children:t.likes}),"\xa0",Object(N.jsx)(L.a,{onClick:n,children:"like"}),Object(N.jsx)(L.a,{onClick:r,children:"remove blog"})]})]})]})},ce=function(e){var t=e.blog,n=Object(o.c)((function(e){return e.user})),r=Object(o.b)(),c=Object(u.g)(),a=function(){var e=Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Are you sure you want to remove ".concat(t.title," from your list?"))){e.next=6;break}return e.next=4,r(F(t.id));case 4:r(q()),c.push("/blogs");case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return t?Object(N.jsxs)("div",{children:[Object(N.jsx)(re,{blog:t,likeBlog:function(){r(function(e,t){return function(){var n=Object(b.a)(j.a.mark((function n(r){var c,a,s,o,i,u,l;return j.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,w.getBlog(e);case 3:return c=n.sent,a=c.comments,s=a.map((function(e){return e.id})),o=c.likes+1,i=Object(S.a)(Object(S.a)({},c),{},{likes:o,comments:s}),n.next=10,w.update(e,i);case 10:u=n.sent,l=V(e,Object(S.a)(Object(S.a)({},u),{},{comments:a}),t),r({type:"LIKE_BLOG",data:l}),n.next=19;break;case 15:n.prev=15,n.t0=n.catch(0),console.log("Met exception"),console.log(n.t0);case 19:case"end":return n.stop()}}),n,null,[[0,15]])})));return function(e){return n.apply(this,arguments)}}()}(t.id,n))},deleteBlog:a}),Object(N.jsx)(ne,{blog:t,postComment:function(e){r(function(e,t){return function(){var n=Object(b.a)(j.a.mark((function n(r){var c,a,s;return j.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,w.addComment(e.id,{content:t});case 3:c=n.sent,a=e.comments.concat({content:c.content,id:c.id}),s=Object(S.a)(Object(S.a)({},e),{},{comments:a}),r({type:"COMMENT_BLOG",data:s}),n.next=13;break;case 9:n.prev=9,n.t0=n.catch(0),console.log("Met exception"),console.log(n.t0);case 13:case"end":return n.stop()}}),n,null,[[0,9]])})));return function(e){return n.apply(this,arguments)}}()}(t,e))}})]}):null},ae=n(119),se=n(120),oe=n(121),ie=n(122),ue=n(123),le=n(124),je=function(e){var t=e.lister,n=e.blogs,r=e.address;return Object(N.jsxs)(ae.a,{children:[Object(N.jsx)(se.a,{children:Object(N.jsx)(i.b,{to:r,children:t.name})}),Object(N.jsx)(se.a,{children:n&&n.length})]})},be=function(){var e=Object(o.c)((function(e){return e.listers}));return e?Object(N.jsxs)(oe.a,{children:[Object(N.jsx)("h2",{children:"Users"}),Object(N.jsxs)(ie.a,{children:[Object(N.jsx)(ue.a,{children:Object(N.jsxs)(ae.a,{children:[Object(N.jsx)(se.a,{}),Object(N.jsx)(se.a,{children:"Blogs created"})]})}),Object(N.jsx)(le.a,{children:e.map((function(e){return Object(N.jsx)(je,{lister:e,blogs:e.blogs,address:"/users/"+e.id},e.id)}))})]})]}):null},de=function(e){var t=e.user;return t?Object(N.jsxs)("div",{children:[Object(N.jsx)("h2",{children:t.name}),Object(N.jsx)("h3",{children:"Added blogs"}),Object(N.jsx)("ul",{children:t.blogs.map((function(e){return Object(N.jsx)("li",{children:e.title},e.id)}))})]}):null},fe=c.a.forwardRef((function(e,t){var n=Object(r.useState)(!1),c=Object(R.a)(n,2),a=c[0],s=c[1],o={display:a?"none":""},i={display:a?"":"none"},u=function(){s(!a)};return Object(r.useImperativeHandle)(t,(function(){return{toggleVisibility:u}})),Object(N.jsxs)("div",{children:[Object(N.jsx)("div",{style:o,children:Object(N.jsx)("button",{onClick:u,children:e.buttonLabel})}),Object(N.jsxs)("div",{style:i,children:[e.children,Object(N.jsx)("button",{onClick:u,children:"cancel"})]})]})}));fe.displayName="Togglable";var pe=fe,Oe=Object(ee.a)({root:{minWidth:275,marginBottom:12},header:{borderBottom:"solid #ecf2f9 2px"}}),he=function(e){var t=e.blog,n=e.address,r=Oe();return Object(N.jsxs)(X.a,{className:r.root,children:[Object(N.jsx)(Y.a,{className:r.header,title:t.title}),Object(N.jsxs)(Z.a,{children:[Object(N.jsxs)("span",{className:"blogLink",children:["by ",t.author]}),Object(N.jsx)($.a,{children:Object(N.jsx)(i.b,{to:n,children:Object(N.jsx)(L.a,{size:"small",children:"See full view"})})})]})]})},xe=function(){var e=Object(o.c)((function(e){return e.user})),t=Object(o.c)((function(t){return t.blog.filter((function(t){return t.user&&t.user.username===e.username})).sort((function(e,t){return t.likes-e.likes}))}));return Object(N.jsxs)("div",{children:[Object(N.jsx)("h3",{children:"Here are your blogs: "}),t.map((function(e){return Object(N.jsx)(he,{blog:e,address:"/blogs/"+e.id},e.id)}))]})},ve=function(e){var t=e.addNewBlog,n=_("text","title"),r=n.reset,c=Object(A.a)(n,["reset"]),a=_("text","author"),s=a.reset,o=Object(A.a)(a,["reset"]),i=_("text","url"),u=i.reset,l=Object(A.a)(i,["reset"]);return Object(N.jsxs)("div",{children:[Object(N.jsx)("h3",{children:"Create new blog"}),Object(N.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t({title:c.value,author:o.value,url:l.value}),r(),s(),u()},children:[Object(N.jsxs)("div",{children:["title:\xa0 ",Object(N.jsx)("input",Object(S.a)({},c))]}),Object(N.jsxs)("div",{children:["author:\xa0 ",Object(N.jsx)("input",Object(S.a)({},o))]}),Object(N.jsxs)("div",{children:["url:\xa0 ",Object(N.jsx)("input",Object(S.a)({},l))]}),Object(N.jsx)("button",{id:"addBlogButton",type:"submit",children:"Create"})]})]})},ge=function(e){var t=e.blogFormRef,n=Object(o.b)(),r=Object(o.c)((function(e){return e.user})),c=function(){var e=Object(b.a)(j.a.mark((function e(c){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.current.toggleVisibility(),e.next=3,n(W(c,r));case 3:n(q()),n(U("Blog titled '".concat(c.title,"' is now added to the list.")));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(N.jsx)(ve,{addNewBlog:c})},me=function(){var e=Object(r.useRef)();return Object(N.jsxs)("div",{children:[Object(N.jsx)(pe,{buttonLabel:"new blog",ref:e,children:Object(N.jsx)(ge,{blogFormRef:e})}),Object(N.jsx)(xe,{})]})},we=n(125),ye=function(){var e=Object(o.b)(),t=Object(o.c)((function(e){return e.user})),n=Object(o.c)((function(e){return e.listers})),c=Object(o.c)((function(e){return e.blog})),a=Object(u.h)("/users/:id"),s=Object(u.h)("/blogs/:id"),i=a?n.find((function(e){return e.id===a.params.id})):null,l=s?c.find((function(e){return e.id===s.params.id})):null;return Object(r.useEffect)((function(){e(function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w.getAll();case 3:n=e.sent,t({type:"INIT_BLOG",data:n}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}())}),[]),Object(r.useEffect)((function(){e(q())}),[]),Object(r.useEffect)((function(){var t=window.localStorage.getItem("loggedBlogAppUser");t&&e(function(e){return function(){var t=Object(b.a)(j.a.mark((function t(n){var r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=JSON.parse(e),w.setToken(r.token),n({type:"RETRIEVE",data:r}),console.log("Uploaded user from local storage: ".concat(r.name));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(t))}),[]),Object(N.jsxs)(we.a,{children:[Object(N.jsx)(G,{}),Object(N.jsx)("h1",{children:"Bloglists!"}),Object(N.jsx)(J,{}),Object(N.jsxs)(u.d,{children:[Object(N.jsx)(u.b,{path:"/users/:id",children:Object(N.jsx)(de,{user:i})}),Object(N.jsx)(u.b,{path:"/blogs/:id",children:Object(N.jsx)(ce,{blog:l})}),Object(N.jsx)(u.b,{path:"/users",children:t?Object(N.jsx)(be,{}):Object(N.jsx)(u.a,{to:"/login"})}),Object(N.jsx)(u.b,{path:"/blogs",children:t?Object(N.jsx)(me,{}):Object(N.jsx)(u.a,{to:"/login"})}),Object(N.jsx)(u.b,{path:"/login",children:t?Object(N.jsx)(u.a,{to:"/users"}):Object(N.jsx)(z,{})}),Object(N.jsx)(u.b,{path:"/",children:t?Object(N.jsx)(u.a,{to:"/users"}):Object(N.jsx)(u.a,{to:"/login"})})]})]})},ke=(n(96),n(32)),Be=n(54),Le=n(55),Ee=Object(ke.combineReducers)({notification:M,blog:K,user:B,listers:Q}),Ie=Object(ke.createStore)(Ee,Object(Le.composeWithDevTools)(Object(ke.applyMiddleware)(Be.a)));s.a.render(Object(N.jsx)(o.a,{store:Ie,children:Object(N.jsx)(i.a,{children:Object(N.jsx)(ye,{})})}),document.getElementById("root"))}},[[97,1,2]]]);
//# sourceMappingURL=main.faaf39e7.chunk.js.map